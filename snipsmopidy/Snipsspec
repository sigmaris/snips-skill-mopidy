package_name: snipsmopidy
class_name: SnipsMopidy
description: Mopidy skill for Snips
params:
  mopidy_rooms:
    default:
      host: localhost
      port: 6600
notifications:
  - name: start_listening
    action: |
      {%
      snips.skill.set_to_low_volume(snips.site_id)
      %}
intents:
  - intent: speakerInterrupt
    action: |
      {%
      snips.skill.pause(snips.site_id)
      %}
  - intent: volumeUp
    action: |
      {%
      snips.skill.set_to_previous_volume(snips.site_id)
      if snips.intent.volume_higher:
        volume_higher = snips.intent.volume_higher[0]
        snips.skill.volume_up(snips.site_id, volume_higher)
      else:
        snips.skill.volume_up(snips.site_id, None)
      %}
  - intent: volumeDown
    action: |
      {%
      snips.skill.set_to_previous_volume(snips.site_id)
      if len(snips.intent.volume_lower):
        volume_lower = snips.intent.volume_lower[0]
        snips.skill.volume_down(snips.site_id, volume_lower)
      else:
        snips.skill.volume_down(snips.site_id, None)
      %}
  - intent: playPlaylist
    action: |
      {%
      if len(snips.intent.playlist_name):
        playlist_name = snips.intent.playlist_name[0]
        #playlist_lecture_mode = snips.intent.playlist_lecture_mode[0] if len(snips.intent.playlist_lecture_mode) else None
        snips.skill.play_playlist(snips.site_id, playlist_name, _shuffle=(len(snips.intent.playlist_lecture_mode) and snips.intent.playlist_lecture_mode[0] == "shuffle"))

      snips.skill.set_to_previous_volume(snips.site_id)
      %}
  - intent: playArtist
    action: |
      {%
      if len(snips.intent.artist_name):
        artist_name = snips.intent.artist_name[0]
        snips.skill.play_artist(snips.site_id, artist_name)
      snips.skill.set_to_previous_volume(snips.site_id)
      %}
  - intent: playSong
    action: |
      {%
      if len(snips.intent.song_name):
        snips.skill.play_song(snips.site_id, snips.intent.song_name)
      snips.skill.set_to_previous_volume(snips.site_id)
      %}
  - intent: playAlbum
    action: |
      {%
      if len(snips.intent.album_name):
        album_name = snips.intent.album_name[0]
        snips.skill.play_album(snips.site_id, album_name, _shuffle=(len(snips.intent.album_lecture_mode) and snips.intent.album_lecture_mode[0] == "shuffle"))

      snips.skill.set_to_previous_volume(snips.site_id)
      %}
  - intent: resumeMusic
    action: |
      {% snips.skill.play(snips.site_id); snips.skill.set_to_previous_volume(snips.site_id) %}
  - intent: nextSong
    action: |
      {% snips.skill.play_next_item_in_queue(snips.site_id); snips.skill.set_to_previous_volume(snips.site_id) %}
  - intent: previousSong
    action: |
      {% snips.skill.play_previous_item_in_queue(snips.site_id); snips.skill.set_to_previous_volume(snips.site_id) %}
  - intent: addSong
    action: |
      {% snips.skill.add_song(snips.site_id); snips.skill.set_to_previous_volume(snips.site_id) %}
  - intent: getInfos
    action: |
      {%
        snips.skill.set_to_previous_volume(snips.site_id); snips.dialogue.speak("This is {} by {} on the album {}".format(*snips.skill.get_info(snips.site_id)))
      %}
  - intent: "*"
    action: |
      {%
        snips.skill.set_to_previous_volume(snips.site_id);
      %}
